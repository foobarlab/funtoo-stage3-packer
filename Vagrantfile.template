# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.require_version ">= 2.1.0"

# TODO grow size?

Vagrant.configure("2") do |config|
  config.vm.box_check_update = true
  config.vm.box = "funtoo-stage3"  # TODO set from config
  config.vm.hostname = "stage3"  # TODO set from config
  config.vm.provider "virtualbox" do |vb|
    vb.gui = false
    vb.memory = "2048"  # TODO set from config
    vb.cpus = "2"  # TODO set from config
    # customize VirtualBox settings
    vb.customize ["modifyvm", :id, "--nictype1", "virtio"]
    vb.customize ["modifyvm", :id, "--audio", "none"]
    vb.customize ["modifyvm", :id, "--usb", "off"]
    vb.customize ["modifyvm", :id, "--rtcuseutc", "on"]
    vb.customize ["modifyvm", :id, "--chipset", "ich9"]
    vb.customize ["modifyvm", :id, "--vram", "12"]
    vb.customize ["modifyvm", :id, "--vrde", "off"]
    vb.customize ["modifyvm", :id, "--hpet", "on"]
    vb.customize ["modifyvm", :id, "--hwvirtex", "on"]
    vb.customize ["modifyvm", :id, "--vtxvpid", "on"]
    vb.customize ["modifyvm", :id, "--largepages", "on"]
    vb.customize ["modifyvm", :id, "--graphicscontroller", "vmsvga"]
    vb.customize ["modifyvm", :id, "--accelerate3d", "off"]
  end
  # TODO add more options here?
  config.ssh.insert_key = true
  config.ssh.connect_timeout = 60
  config.vm.synced_folder '.', '/vagrant', disabled: true  # TODO should we enable this?
end
